<font size=4 face='楷体'>

## 压缩&解压

tar

```
-c: 建立压缩档案
-x：解压
-t：查看内容
-r：向压缩归档文件末尾追加文件
-u：更新原压缩包中的文件
```

这五个是独立的命令，压缩解压都要用到其中一个，可以和别的命令连用但只能用其中一个。下面的参数是根据需要在压缩或解压档案时可选的

```
-z：有gzip属性的
-j：有bz2属性的
-Z：有compress属性的
-v：显示所有过程
-O：将文件解开到标准输出
```

下面的参数是必须的

```
-f: 使用档案名字，切记，这个参数是最后一个参数，后面只能接档案名
```

eg.
压缩

```
tar –cvf jpg.tar *.jpg //将目录里所有jpg文件打包成tar.jpg
tar –czf jpg.tar.gz *.jpg   //将目录里所有jpg文件打包成jpg.tar后，并且将其用gzip压缩，生成一个gzip压缩过的包，命名为jpg.tar.gz
tar –cjf jpg.tar.bz2 *.jpg //将目录里所有jpg文件打包成jpg.tar后，并且将其用bzip2压缩，生成一个bzip2压缩过的包，命名为jpg.tar.bz2
tar –cZf jpg.tar.Z *.jpg   //将目录里所有jpg文件打包成jpg.tar后，并且将其用compress压缩，生成一个umcompress压缩过的包，命名为jpg.tar.Z
rar a jpg.rar *.jpg //rar格式的压缩，需要先下载rar for Linux
zip jpg.zip *.jpg //zip格式的压缩，需要先下载zip for linux
```

解压

```
tar –xvf file.tar //解压 tar包
tar -xzvf file.tar.gz //解压tar.gz
tar -xjvf file.tar.bz2   //解压 tar.bz2
tar –xZvf file.tar.Z   //解压tar.Z
unrar e file.rar //解压rar
unzip file.zip //解压zip
```

总结

```
1、*.tar 用 tar –xvf 解压
2、*.gz 用 gzip -d或者gunzip 解压
3、*.tar.gz和*.tgz 用 tar –xzf 解压
4、*.bz2 用 bzip2 -d或者用bunzip2 解压
5、*.tar.bz2用tar –xjf 解压
6、*.Z 用 uncompress 解压
7、*.tar.Z 用tar –xZf 解压
8、*.rar 用 unrar e解压
9、*.zip 用 unzip 解压
```

```bash
# 压缩
tar -zcvf filename.tar.gz filename

# 解压
tar -xvf ilename.tar.gz
```

### gzip 压缩&解压

| 选项   | 含义                                               |
|--------|----------------------------------------------------|
| -c     | 将压缩数据输出到标准输出中，并保留源文件。          |
| -d     | 对压缩文件进行解压缩。                             |
| -r     | 递归压缩指定目录下以及子目录下的所有文件。           |
| -v     | 对于每个压缩和解压缩的文件，显示相应的文件名和压缩比。|
| -l     | 对每一个压缩文件，显示以下字段：<br> - 压缩文件的大小；<br>  - 未压缩文件的大小；<br>  - 压缩比；<br>  - 未压缩文件的名称。|
| -数字   | 用于指定压缩等级，-1 压缩等级最低，压缩比最差；-9 压缩比最高。默认压缩比是 -6。|


### 在 Centos 上安装 unrar

- 直接安装

  ```bash
  yum install unrar
  ```

- 在[rarlab](https://www.rarlab.com/download.htm)官网找到相应的版本进行下载

  ```bash
  # 下载
  wget https://www.rarlab.com/rar/rarlinux-x64-6.0.0.tar.gz
  # 解压
  tar xf rarlinux-x64-6.0.0.tar.gz -C /usr/local/

  ln -s /usr/local/rar/rar /usr/local/bin/rar
  ln -s /usr/local/rar/unrar /usr/local/bin/unrar
  ```

  ```bash
  # 解压压缩文件到当前目录
  unrar e test.rar
  # 用绝对路径解压文件
  unrar x test.rar
  # 列出压缩包中的文件列表信息（简单）
  unrar l test.rar
  # 列出压缩包中的文件列表信息（详细）
  unrar v test.rar
  # 测试压缩文件
  unrar t test.rar
  ```

### 通过 python 执行 unrar 的相关操作

```bash
pip3 install unrar
```

```bash
from unrar import rarfile
```

如果运行没问题则证明安装成功，如果报`Couldn't find path to unrar library`则还需要系统编译安装 unrar

```bash
yum install -y gcc gcc-c++
```

```bash
wget http://www.rarlab.com/rar/unrarsrc-5.4.5.tar.gz
tar zxf unrarsrc-5.4.5.tar.gz
cd unrar
```

```bash
make lib
make install-lib
```

使用 make lib 命令将会自动编译库文件，再使用 make install-lib 命令产生 libunrar.so 文件（一般在 /usr/lib 目录下面）

```bash
vim /etc/profile
```

```bash
export UNRAR_LIB_PATH=/usr/lib/libunrar.so
```

```bash
source /etc/profile
```

简单示例

```python
from unrar import rarfile


rar = rarfile.RarFile('sample.rar')
print(rar.namelist())  # 压缩包的文件列表

rar.printdir()  # 打印压缩包的文件信息（详细）

info = rar.infolist() # 文件信息迭代器对象列表
for f in info:
    print(f.filename, f.file_size, f.date_time)  # 文件名 文件大小 修改时间

rar.extractall()  # 解压
```

### Reference

[linux tar.gz zip 解压缩 压缩命令](https://www.cnblogs.com/diandianquanquan/p/11031841.html)
[tar\_压缩](https://www.jianshu.com/p/e8a45d7cb838)
[centos 打压缩包以及解压的命令](https://blog.csdn.net/Eider1998/article/details/107631186)
[Centos 使用 unrar 解压 rar 压缩包](https://www.cnblogs.com/blueberry-mint/p/14167244.html)
[Linux gzip命令：压缩文件或目录](https://c.biancheng.net/view/783.html)

**Create On 2020.11.05, Update on 2023.08.11**
