<font size=4 face='楷体'>

## 微信公众号扫码登录逻辑

- 准备材料
- - 已认证的公众号 (必须为服务号, 订阅号没有该接口的权限)
- - 微信回调地址, 本地可能需要内网穿透


- 实现原理
- - 使用微信公众号(服务号)的 `appId` 和 `appSecret` 生成一个 token, 这个 token 可以复用, 但是有时效性

- - 使用 token 当做参数调用微信 api `qrcode/create` 创建一个二维码

- - 使用微信扫码, 用户订阅后, 微信官方会回调我们的一个地址, 将 openId 传过来

- - 将 openId 保存下来, 下次扫描时根据 openId 进行判断用户身份

- 注意点
- - 只有服务号才有生成带参数的二维码接口权限

- - 该接口每天 100000 次, 适用于小规模用户登录

- - 获取的 AccessToken 有时效性, 可以利用 redis 进行保存

- - 公众号开发有白名单限制, 所以服务端在调用时需要配置白名单

### Reference

[微信小程序入门5-微信公众号扫码登录PC端网页](https://blog.csdn.net/weixin_33005117/article/details/125100049)

**2022.12.08**
